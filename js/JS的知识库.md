# JSçš„çŸ¥è¯†åº“~

# ç®­å¤´å‡½æ•°æ¯”è‡ªå·±å†™çš„è¦å¿«ï¼Ÿ

ä½ çš„ä¸¤ä¸ª `createCounter` å‡½æ•°åœ¨åŠŸèƒ½ä¸Šæ˜¯ç›¸åŒçš„ï¼Œä½† **ç¬¬ä¸€ä¸ªç‰ˆæœ¬æ¯”ç¬¬äºŒä¸ªç‰ˆæœ¬æ›´å¿«**ï¼Œä¸»è¦åŸå› æ˜¯ï¼š

---

### **1. `ç®­å¤´å‡½æ•°` vs. `ä¼ ç»Ÿæ–¹æ³•å®šä¹‰`**
#### **ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼ˆæ›´å¿«çš„ç‰ˆæœ¬ï¼‰**ï¼š
```javascript
return {
    increment: () => ++n,
    decrement: () => --n,
    reset: () => (n = init)
};
```
- ä½¿ç”¨ **ç®­å¤´å‡½æ•°ï¼ˆ`=>`ï¼‰**ï¼ŒJavaScript å¼•æ“å¯ä»¥æ›´å¥½åœ°ä¼˜åŒ–å®ƒä»¬ï¼Œå› ä¸ºå®ƒä»¬ï¼š
  - æ²¡æœ‰è‡ªå·±çš„ `this` ç»‘å®šï¼ˆæ›´å¿«è®¿é—®å¤–å±‚ä½œç”¨åŸŸçš„ `this`ï¼‰ã€‚
  - ä¸ä¼šåœ¨æ¯æ¬¡è°ƒç”¨æ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„ `this` ä¸Šä¸‹æ–‡ï¼ˆæ›´è½»é‡ï¼‰ã€‚

#### **ç¬¬äºŒä¸ªç‰ˆæœ¬ï¼ˆç¨æ…¢çš„ç‰ˆæœ¬ï¼‰**ï¼š
```javascript
return {
    increment() { ... },
    decrement() { ... },
    reset() { ... }
};
```
- ä½¿ç”¨ä¼ ç»Ÿ **æ–¹æ³•ç®€å†™ï¼ˆ`method() { ... }`ï¼‰**ï¼Œè™½ç„¶è¯­æ³•æ›´å¹²å‡€ï¼Œä½†ï¼š
  - æ¯æ¬¡è°ƒç”¨éƒ½ä¼šç»‘å®š `this`ï¼ˆå³ä½¿ä½ åœ¨è¿™é‡Œæ²¡ä½¿ç”¨ `this`ï¼‰ã€‚
  - ç›¸æ¯”ç®­å¤´å‡½æ•°ï¼Œå¼•æ“ä¼˜åŒ–å°‘ä¸€äº›ï¼Œå¯èƒ½ç•¥å¾®é™ä½æ€§èƒ½ã€‚

---

### **2. `++x`ï¼ˆå‰ç¼€ï¼‰ vs. `x++`ï¼ˆåç¼€ï¼‰**
å°½ç®¡åœ¨ JS ä¸­ `++x` å’Œ `x++` çš„æ€§èƒ½å·®è·å¯ä»¥å¿½ç•¥ä¸è®¡ï¼ˆç°ä»£ JS å¼•æ“ä¼šä¼˜åŒ–ï¼‰ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼š
- **`++n`**ï¼ˆç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼‰å…ˆé€’å¢å†è¿”å›å€¼ï¼Œæ¯” **`n++`**ï¼ˆç¬¬äºŒä¸ªç‰ˆæœ¬å…ˆè¿”å›å†é€’å¢ï¼‰å°‘äº†ä¸€æ¬¡ä¸´æ—¶å˜é‡åˆ†é…ã€‚
- **`--n`** åŒç†ï¼Œæ¯” `n--` æ›´å¿«ã€‚

ä½†è¿™éƒ¨åˆ†å½±å“å¾ˆå°ï¼Œä¸»è¦æ˜¯ç®­å¤´å‡½æ•°ä¸ä¼ ç»Ÿæ–¹æ³•çš„å·®å¼‚ã€‚

---

### **3. **æ›´ç²¾ç®€çš„ä½œç”¨åŸŸé“¾**
- **ç¬¬ä¸€ä¸ªç‰ˆæœ¬**ä½¿ç”¨äº† **é—­åŒ…å˜é‡ `n`**ï¼Œè®¿é—®é€Ÿåº¦æ¯” **æ–¹æ³•å†…éƒ¨å˜é‡ `start`** æ›´å¿«ï¼š
  - `n` æ˜¯ç›´æ¥è®¿é—®çš„ï¼Œè€Œ `start` å¯èƒ½æ¶‰åŠ `this` æŸ¥æ‰¾ï¼ˆå³ä½¿ä½ æ²¡ç”¨ `this`ï¼ŒJS å¯èƒ½ä»è¦å¤„ç†ï¼‰ã€‚
- **ç®­å¤´å‡½æ•°** ç”±äºæ²¡æœ‰ `this`ï¼Œå¼•æ“å¯ä»¥æ›´é«˜æ•ˆåœ°æŸ¥æ‰¾å˜é‡ã€‚

---

### **å¦‚ä½•éªŒè¯ï¼Ÿ**
#### **Benchmark æµ‹è¯•**
åœ¨ Node.js æˆ–æµè§ˆå™¨æ§åˆ¶å°è¯•è¯•ï¼š
```javascript
const test1 = () => {
    const counter = createCounter(0);
    for (let i = 0; i < 1000000; i++) {
        counter.increment();
    }
};

const test2 = () => {
    const counter = createCounter2(0);
    for (let i = 0; i < 1000000; i++) {
        counter.increment();
    }
};

console.time("Test 1");
test1();
console.timeEnd("Test 1");

console.time("Test 2");
test2();
console.timeEnd("Test 2");
```
ä½ ä¼šå‘ç° **ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼ˆç®­å¤´å‡½æ•°ï¼‰å‡ ä¹æ€»æ˜¯æ›´å¿«**ï¼ˆå°¤å…¶åœ¨å¤šæ¬¡è°ƒç”¨æ—¶ï¼‰ã€‚

---

### **ç»“è®º**
| Version        | è¯­è¨€ç‰¹æ€§         | ä¼˜åŒ–ç¨‹åº¦       | æ€§èƒ½       |
| -------------- | ---------------- | -------------- | ---------- |
| **ç¬¬ä¸€ä¸ªç‰ˆæœ¬** | `ç®­å¤´å‡½æ•° + ++x` | âœ… å¼•æ“ä¼˜åŒ–æ›´å¥½ | âš¡ **æ›´å¿«** |
| **ç¬¬äºŒä¸ªç‰ˆæœ¬** | `ä¼ ç»Ÿæ–¹æ³• + x++` | âš  å°‘é‡é¢å¤–å¼€é”€ | ğŸ¢ ç¨æ…¢     |

**å¦‚æœä½ åœ¨ä¹æ€§èƒ½ï¼Œé€‰æ‹©ç¬¬ä¸€ç§å†™æ³•ï¼ˆç®­å¤´å‡½æ•° + å‰ç¼€æ“ä½œï¼‰ã€‚**

å¦‚æœæƒ³ä»£ç æ›´å¯è¯»ï¼Œç¬¬äºŒç§å†™æ³•ä¹Ÿæ²¡é—®é¢˜ï¼ğŸ› 