# JSçš„çŸ¥è¯†åº“~

# ç®­å¤´å‡½æ•°æ¯”è‡ªå·±å†™çš„è¦å¿«ï¼Ÿ

ä½ çš„ä¸¤ä¸ª `createCounter` å‡½æ•°åœ¨åŠŸèƒ½ä¸Šæ˜¯ç›¸åŒçš„ï¼Œä½† **ç¬¬ä¸€ä¸ªç‰ˆæœ¬æ¯”ç¬¬äºŒä¸ªç‰ˆæœ¬æ›´å¿«**ï¼Œä¸»è¦åŸå› æ˜¯ï¼š

---

### **1. `ç®­å¤´å‡½æ•°` vs. `ä¼ ç»Ÿæ–¹æ³•å®šä¹‰`**
#### **ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼ˆæ›´å¿«çš„ç‰ˆæœ¬ï¼‰**ï¼š
```javascript
return {
    increment: () => ++n,
    decrement: () => --n,
    reset: () => (n = init)
};
```
- ä½¿ç”¨ **ç®­å¤´å‡½æ•°ï¼ˆ`=>`ï¼‰**ï¼ŒJavaScript å¼•æ“å¯ä»¥æ›´å¥½åœ°ä¼˜åŒ–å®ƒä»¬ï¼Œå› ä¸ºå®ƒä»¬ï¼š
  - æ²¡æœ‰è‡ªå·±çš„ `this` ç»‘å®šï¼ˆæ›´å¿«è®¿é—®å¤–å±‚ä½œç”¨åŸŸçš„ `this`ï¼‰ã€‚
  - ä¸ä¼šåœ¨æ¯æ¬¡è°ƒç”¨æ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„ `this` ä¸Šä¸‹æ–‡ï¼ˆæ›´è½»é‡ï¼‰ã€‚

#### **ç¬¬äºŒä¸ªç‰ˆæœ¬ï¼ˆç¨æ…¢çš„ç‰ˆæœ¬ï¼‰**ï¼š
```javascript
return {
    increment() { ... },
    decrement() { ... },
    reset() { ... }
};
```
- ä½¿ç”¨ä¼ ç»Ÿ **æ–¹æ³•ç®€å†™ï¼ˆ`method() { ... }`ï¼‰**ï¼Œè™½ç„¶è¯­æ³•æ›´å¹²å‡€ï¼Œä½†ï¼š
  - æ¯æ¬¡è°ƒç”¨éƒ½ä¼šç»‘å®š `this`ï¼ˆå³ä½¿ä½ åœ¨è¿™é‡Œæ²¡ä½¿ç”¨ `this`ï¼‰ã€‚
  - ç›¸æ¯”ç®­å¤´å‡½æ•°ï¼Œå¼•æ“ä¼˜åŒ–å°‘ä¸€äº›ï¼Œå¯èƒ½ç•¥å¾®é™ä½æ€§èƒ½ã€‚

---

### **2. `++x`ï¼ˆå‰ç¼€ï¼‰ vs. `x++`ï¼ˆåç¼€ï¼‰**
å°½ç®¡åœ¨ JS ä¸­ `++x` å’Œ `x++` çš„æ€§èƒ½å·®è·å¯ä»¥å¿½ç•¥ä¸è®¡ï¼ˆç°ä»£ JS å¼•æ“ä¼šä¼˜åŒ–ï¼‰ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼š
- **`++n`**ï¼ˆç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼‰å…ˆé€’å¢å†è¿”å›å€¼ï¼Œæ¯” **`n++`**ï¼ˆç¬¬äºŒä¸ªç‰ˆæœ¬å…ˆè¿”å›å†é€’å¢ï¼‰å°‘äº†ä¸€æ¬¡ä¸´æ—¶å˜é‡åˆ†é…ã€‚
- **`--n`** åŒç†ï¼Œæ¯” `n--` æ›´å¿«ã€‚

ä½†è¿™éƒ¨åˆ†å½±å“å¾ˆå°ï¼Œä¸»è¦æ˜¯ç®­å¤´å‡½æ•°ä¸ä¼ ç»Ÿæ–¹æ³•çš„å·®å¼‚ã€‚

---

### **3. **æ›´ç²¾ç®€çš„ä½œç”¨åŸŸé“¾**
- **ç¬¬ä¸€ä¸ªç‰ˆæœ¬**ä½¿ç”¨äº† **é—­åŒ…å˜é‡ `n`**ï¼Œè®¿é—®é€Ÿåº¦æ¯” **æ–¹æ³•å†…éƒ¨å˜é‡ `start`** æ›´å¿«ï¼š
  - `n` æ˜¯ç›´æ¥è®¿é—®çš„ï¼Œè€Œ `start` å¯èƒ½æ¶‰åŠ `this` æŸ¥æ‰¾ï¼ˆå³ä½¿ä½ æ²¡ç”¨ `this`ï¼ŒJS å¯èƒ½ä»è¦å¤„ç†ï¼‰ã€‚
- **ç®­å¤´å‡½æ•°** ç”±äºæ²¡æœ‰ `this`ï¼Œå¼•æ“å¯ä»¥æ›´é«˜æ•ˆåœ°æŸ¥æ‰¾å˜é‡ã€‚

---

### **å¦‚ä½•éªŒè¯ï¼Ÿ**
#### **Benchmark æµ‹è¯•**
åœ¨ Node.js æˆ–æµè§ˆå™¨æ§åˆ¶å°è¯•è¯•ï¼š
```javascript
const test1 = () => {
    const counter = createCounter(0);
    for (let i = 0; i < 1000000; i++) {
        counter.increment();
    }
};

const test2 = () => {
    const counter = createCounter2(0);
    for (let i = 0; i < 1000000; i++) {
        counter.increment();
    }
};

console.time("Test 1");
test1();
console.timeEnd("Test 1");

console.time("Test 2");
test2();
console.timeEnd("Test 2");
```
ä½ ä¼šå‘ç° **ç¬¬ä¸€ä¸ªç‰ˆæœ¬ï¼ˆç®­å¤´å‡½æ•°ï¼‰å‡ ä¹æ€»æ˜¯æ›´å¿«**ï¼ˆå°¤å…¶åœ¨å¤šæ¬¡è°ƒç”¨æ—¶ï¼‰ã€‚

---

### **ç»“è®º**
| Version        | è¯­è¨€ç‰¹æ€§         | ä¼˜åŒ–ç¨‹åº¦       | æ€§èƒ½       |
| -------------- | ---------------- | -------------- | ---------- |
| **ç¬¬ä¸€ä¸ªç‰ˆæœ¬** | `ç®­å¤´å‡½æ•° + ++x` | âœ… å¼•æ“ä¼˜åŒ–æ›´å¥½ | âš¡ **æ›´å¿«** |
| **ç¬¬äºŒä¸ªç‰ˆæœ¬** | `ä¼ ç»Ÿæ–¹æ³• + x++` | âš  å°‘é‡é¢å¤–å¼€é”€ | ğŸ¢ ç¨æ…¢     |

**å¦‚æœä½ åœ¨ä¹æ€§èƒ½ï¼Œé€‰æ‹©ç¬¬ä¸€ç§å†™æ³•ï¼ˆç®­å¤´å‡½æ•° + å‰ç¼€æ“ä½œï¼‰ã€‚**

å¦‚æœæƒ³ä»£ç æ›´å¯è¯»ï¼Œç¬¬äºŒç§å†™æ³•ä¹Ÿæ²¡é—®é¢˜ï¼ğŸ› 





# `forEach`ã€`for...in` å’Œ `for...of` 

åœ¨ JavaScript ä¸­ï¼Œ`forEach`ã€`for...in` å’Œ `for...of` æ˜¯ä¸‰ç§ä¸åŒçš„å¾ªç¯æ–¹å¼ï¼Œå®ƒä»¬å„è‡ªé€‚ç”¨äºä¸åŒçš„åœºæ™¯ï¼Œå¹¶ä¸”æœ‰æ˜¾è‘—çš„åŒºåˆ«ã€‚ä»¥ä¸‹æ˜¯å®ƒä»¬çš„è¯¦ç»†å¯¹æ¯”ï¼š

---

## **1. `forEach`ï¼ˆæ•°ç»„æ–¹æ³•ï¼‰**
### **ç‰¹ç‚¹**
- **ä¸“ä¸ºæ•°ç»„è®¾è®¡**ï¼Œæ˜¯ `Array.prototype` çš„æ–¹æ³•ã€‚
- **ä¸èƒ½ç”¨äºæ™®é€šå¯¹è±¡**ï¼ˆé™¤éå…ˆè½¬æ¢æˆæ•°ç»„ï¼Œå¦‚ `Object.keys(obj).forEach`ï¼‰ã€‚
- **ä¸èƒ½ä½¿ç”¨ `break` æˆ– `continue`**ï¼Œåªèƒ½é€šè¿‡ `return` è·³è¿‡å½“å‰è¿­ä»£ï¼ˆç±»ä¼¼ `continue`ï¼‰ã€‚
- **æ²¡æœ‰è¿”å›å€¼**ï¼ˆé™¤éæ‰‹åŠ¨æ”¶é›†ç»“æœï¼‰ã€‚

### **è¯­æ³•**
```javascript
array.forEach((item, index, array) => {
  // æ“ä½œ item
});
```

### **ç¤ºä¾‹**
```javascript
const arr = [1, 2, 3];
arr.forEach((num, i) => {
  console.log(num, i); // 1 0, 2 1, 3 2
});
```

### **é€‚ç”¨åœºæ™¯**
- éå†æ•°ç»„å¹¶å¯¹æ¯ä¸ªå…ƒç´ æ‰§è¡Œæ“ä½œã€‚
- ä¸éœ€è¦æå‰ç»ˆæ­¢å¾ªç¯çš„æƒ…å†µã€‚

---

## **2. `for...in`ï¼ˆéå†å¯¹è±¡çš„å¯æšä¸¾å±æ€§ï¼‰**
### **ç‰¹ç‚¹**
- **ç”¨äºéå†å¯¹è±¡çš„é”®ï¼ˆå±æ€§åï¼‰**ï¼ŒåŒ…æ‹¬åŸå‹é“¾ä¸Šçš„å¯æšä¸¾å±æ€§ã€‚
- **ä¸ä¿è¯é¡ºåº**ï¼ˆå°¤å…¶æ˜¯æ•°å­—é”®ï¼Œå¯èƒ½æŒ‰æ’å…¥é¡ºåºæˆ–æ•°å­—å‡åºï¼‰ã€‚
- **ä¸é€‚åˆéå†æ•°ç»„**ï¼ˆä¼šéå†æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼ŒåŒ…æ‹¬éæ•°å­—é”®ï¼‰ã€‚
- **å¯ä»¥é…åˆ `hasOwnProperty` è¿‡æ»¤åŸå‹é“¾å±æ€§**ã€‚

### **è¯­æ³•**
```javascript
for (const key in object) {
  if (object.hasOwnProperty(key)) { // è¿‡æ»¤åŸå‹é“¾å±æ€§
    console.log(key, object[key]);
  }
}
```

### **ç¤ºä¾‹**
```javascript
const obj = { a: 1, b: 2 };
for (const key in obj) {
  console.log(key, obj[key]); // 'a' 1, 'b' 2
}

// æ•°ç»„ï¼ˆä¸æ¨èï¼‰
const arr = [10, 20];
arr.foo = 'bar'; // æ·»åŠ éæ•°å­—å±æ€§
for (const key in arr) {
  console.log(key); // '0', '1', 'foo'ï¼ˆåŒ…æ‹¬éæ•°å­—é”®ï¼‰
}
```

### **é€‚ç”¨åœºæ™¯**
- éå†å¯¹è±¡çš„å±æ€§ï¼ˆéœ€æ³¨æ„åŸå‹é“¾ï¼‰ã€‚
- è°ƒè¯•æ—¶æ£€æŸ¥å¯¹è±¡çš„æ‰€æœ‰å¯æšä¸¾å±æ€§ã€‚

---

## **3. `for...of`ï¼ˆéå†å¯è¿­ä»£å¯¹è±¡çš„å€¼ï¼‰**
### **ç‰¹ç‚¹**
- **ç”¨äºéå†å¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚æ•°ç»„ã€å­—ç¬¦ä¸²ã€Mapã€Set ç­‰ï¼‰çš„å€¼**ã€‚
- **ä¸èƒ½ç›´æ¥éå†æ™®é€šå¯¹è±¡**ï¼ˆé™¤éå®ç° `[Symbol.iterator]` æ–¹æ³•ï¼‰ã€‚
- **æ”¯æŒ `break` å’Œ `continue`**ã€‚
- **æŒ‰é¡ºåºéå†**ï¼ˆä¸ `for...in` ä¸åŒï¼‰ã€‚

### **è¯­æ³•**
```javascript
for (const value of iterable) {
  console.log(value);
}
```

### **ç¤ºä¾‹**
```javascript
// æ•°ç»„
const arr = [1, 2, 3];
for (const num of arr) {
  if (num === 2) break; // æ”¯æŒ break
  console.log(num); // 1
}

// å­—ç¬¦ä¸²
const str = 'hello';
for (const char of str) {
  console.log(char); // 'h', 'e', 'l', 'l', 'o'
}

// Map
const map = new Map([['a', 1], ['b', 2]]);
for (const [key, value] of map) {
  console.log(key, value); // 'a' 1, 'b' 2
}
```

### **é€‚ç”¨åœºæ™¯**
- éå†æ•°ç»„ã€å­—ç¬¦ä¸²ã€Mapã€Set ç­‰å¯è¿­ä»£å¯¹è±¡ã€‚
- éœ€è¦æ”¯æŒ `break` æˆ– `continue` çš„æƒ…å†µã€‚

---

## **å¯¹æ¯”æ€»ç»“**
| ç‰¹æ€§             | `forEach`       | `for...in`       | `for...of`                 |
| ---------------- | --------------- | ---------------- | -------------------------- |
| **é€‚ç”¨å¯¹è±¡**     | æ•°ç»„            | å¯¹è±¡             | å¯è¿­ä»£å¯¹è±¡ï¼ˆæ•°ç»„ã€Map ç­‰ï¼‰ |
| **éå†å†…å®¹**     | å…ƒç´ å€¼          | é”®ï¼ˆå±æ€§åï¼‰     | å€¼                         |
| **æ”¯æŒ `break`** | âŒ               | âœ…                | âœ…                          |
| **é¡ºåºä¿è¯**     | âœ…ï¼ˆæ•°ç»„é¡ºåºï¼‰   | âŒï¼ˆä¸ä¿è¯é¡ºåºï¼‰  | âœ…ï¼ˆæŒ‰è¿­ä»£é¡ºåºï¼‰            |
| **åŸå‹é“¾å±æ€§**   | ä¸æ¶‰åŠ          | ä¼šéå†ï¼ˆéœ€è¿‡æ»¤ï¼‰ | ä¸æ¶‰åŠ                     |
| **æ™®é€šå¯¹è±¡æ”¯æŒ** | âŒï¼ˆéœ€å…ˆè½¬æ•°ç»„ï¼‰ | âœ…                | âŒï¼ˆé™¤éå®ç°è¿­ä»£å™¨ï¼‰        |

---

## **å¦‚ä½•é€‰æ‹©ï¼Ÿ**
1. **éå†æ•°ç»„**ï¼š
   - éœ€è¦ `break`/`continue` â†’ `for...of`ã€‚
   - ç®€å•æ“ä½œ â†’ `forEach`ã€‚
2. **éå†å¯¹è±¡å±æ€§**ï¼š
   - ç”¨ `for...in` + `hasOwnProperty`ã€‚
3. **éå† Map/Set/å­—ç¬¦ä¸²**ï¼š
   - ç”¨ `for...of`ã€‚

---

## **ç»å…¸é¢è¯•é¢˜**
### **é—®é¢˜ï¼šä»¥ä¸‹ä»£ç è¾“å‡ºä»€ä¹ˆï¼Ÿ**
```javascript
const arr = [1, 2, 3];
arr.foo = 'bar';

for (const key in arr) {
  console.log(key);
}
```
**ç­”æ¡ˆ**ï¼š`'0', '1', '2', 'foo'`ï¼ˆ`for...in` ä¼šéå†æ‰€æœ‰å¯æšä¸¾å±æ€§ï¼ŒåŒ…æ‹¬éæ•°å­—é”®ï¼‰ã€‚

### **å¦‚ä½•ä¿®å¤ï¼Ÿ**
```javascript
for (const key in arr) {
  if (arr.hasOwnProperty(key) && !isNaN(parseInt(key, 10))) {
    console.log(key); // '0', '1', '2'
  }
}
```

---

å¸Œæœ›è¿™ä¸ªå¯¹æ¯”èƒ½å¸®åŠ©ä½ æ¸…æ™°åŒºåˆ†è¿™ä¸‰ç§å¾ªç¯æ–¹å¼ï¼ ğŸš€





# Const

åœ¨ JavaScript ä¸­ï¼Œä½¿ç”¨ `const` å£°æ˜å˜é‡å’Œ `Map` æ—¶ï¼Œå®ƒä»¬çš„â€œä¸å¯å˜æ€§â€è¡¨ç°ä¸åŒï¼Œå…·ä½“å–å†³äºæ•°æ®ç±»å‹ï¼ˆåŸºæœ¬ç±»å‹ vs å¼•ç”¨ç±»å‹ï¼‰ã€‚ä»¥ä¸‹æ˜¯è¯¦ç»†è§£é‡Šï¼š

---

## **1. `const` çš„åŸºæœ¬è§„åˆ™**
- **`const` å£°æ˜çš„å˜é‡ä¸èƒ½è¢«é‡æ–°èµ‹å€¼**ï¼ˆå³ä¸èƒ½æŒ‡å‘æ–°çš„å†…å­˜åœ°å€ï¼‰ã€‚
- **ä½†å¯¹äºå¼•ç”¨ç±»å‹ï¼ˆå¦‚å¯¹è±¡ã€æ•°ç»„ã€Mapï¼‰**ï¼Œ`const` ä»…é™åˆ¶å˜é‡åç»‘å®šï¼Œä¸é™åˆ¶å¯¹è±¡å†…éƒ¨çš„å˜åŒ–ã€‚

### **ç¤ºä¾‹å¯¹æ¯”**
| æƒ…å†µ                                      | æ˜¯å¦æŠ¥é”™ | åŸå›                                          |
| ----------------------------------------- | -------- | -------------------------------------------- |
| `const num = 1; num = 2;`                 | âœ… æŠ¥é”™   | åŸºæœ¬ç±»å‹çš„å€¼ä¸å¯å˜ï¼ˆä¸èƒ½é‡æ–°èµ‹å€¼ï¼‰ã€‚         |
| `const arr = []; arr = [1];`              | âœ… æŠ¥é”™   | ä¸èƒ½é‡æ–°èµ‹å€¼ï¼ˆæ”¹å˜å˜é‡æŒ‡å‘çš„å†…å­˜åœ°å€ï¼‰ã€‚     |
| `const arr = []; arr.push(1);`            | âŒ ä¸æŠ¥é”™ | å¯ä»¥ä¿®æ”¹å¼•ç”¨ç±»å‹å†…éƒ¨çš„å†…å®¹ï¼ˆå†…å­˜åœ°å€æœªå˜ï¼‰ã€‚ |
| `const map = new Map(); map.set('a', 1);` | âŒ ä¸æŠ¥é”™ | å¯ä»¥ä¿®æ”¹ `Map` çš„å†…å®¹ï¼ˆå†…å­˜åœ°å€æœªå˜ï¼‰ã€‚      |

---

## **2. ä¸ºä»€ä¹ˆ `const` èƒ½ç”¨äº `Map`ï¼Ÿ**
- `Map` æ˜¯å¼•ç”¨ç±»å‹ï¼Œ`const` ä»…ä¿è¯å˜é‡å `map` å§‹ç»ˆæŒ‡å‘åŒä¸€ä¸ª `Map` å®ä¾‹ã€‚
- **å…è®¸çš„æ“ä½œ**ï¼š
  ```javascript
  const map = new Map();
  map.set('key', 'value'); // âœ… ä¿®æ”¹å†…éƒ¨æ•°æ®
  map.delete('key');       // âœ… åˆ é™¤é”®å€¼å¯¹
  map.clear();             // âœ… æ¸…ç©º Map
  ```
- **ç¦æ­¢çš„æ“ä½œ**ï¼š
  ```javascript
  const map = new Map();
  map = new Map(); // âŒ æŠ¥é”™ï¼ä¸èƒ½é‡æ–°èµ‹å€¼
  ```

---

## **3. ç±»æ¯”å…¶ä»–å¼•ç”¨ç±»å‹**
### **ï¼ˆ1ï¼‰å¯¹è±¡ï¼ˆObjectï¼‰**
```javascript
const obj = { a: 1 };
obj.a = 2;      // âœ… ä¿®æ”¹å±æ€§
obj.b = 3;      // âœ… æ·»åŠ å±æ€§
delete obj.a;   // âœ… åˆ é™¤å±æ€§
obj = {};       // âŒ æŠ¥é”™ï¼ä¸èƒ½é‡æ–°èµ‹å€¼
```

### **ï¼ˆ2ï¼‰æ•°ç»„ï¼ˆArrayï¼‰**
```javascript
const arr = [1];
arr.push(2);    // âœ… ä¿®æ”¹å†…å®¹
arr[0] = 3;     // âœ… ä¿®æ”¹å…ƒç´ 
arr = [4];      // âŒ æŠ¥é”™ï¼ä¸èƒ½é‡æ–°èµ‹å€¼
```

---

## **4. ä¸ºä»€ä¹ˆæ¨èç”¨ `const` å£°æ˜ `Map`ï¼Ÿ**
1. **é¿å…æ„å¤–é‡æ–°èµ‹å€¼**ï¼š
   - é˜²æ­¢å› è¯¯æ“ä½œå¯¼è‡´ `Map` å®ä¾‹è¢«æ›¿æ¢ï¼ˆé€»è¾‘é”™è¯¯ï¼‰ã€‚
   ```javascript
   let map = new Map();
   map = new Map(); // å¯èƒ½æ— æ„ä¸­è¦†ç›–åŸæœ‰æ•°æ®ï¼ˆç”¨ const å¯é¿å…ï¼‰
   ```
2. **ä»£ç æ„å›¾æ›´æ¸…æ™°**ï¼š
   - æ˜ç¡®è¡¨ç¤ºè¯¥å˜é‡æŒ‡å‘çš„ `Map` å®ä¾‹ä¸ä¼šæ”¹å˜ï¼ˆå°½ç®¡å†…å®¹å¯å˜ï¼‰ã€‚
3. **ç¬¦åˆå‡½æ•°å¼ç¼–ç¨‹å®è·µ**ï¼š
   - å°½é‡ä½¿ç”¨ `const` å‡å°‘å¯å˜çŠ¶æ€ï¼Œæå‡ä»£ç å¯ç»´æŠ¤æ€§ã€‚

---

## **5. å¦‚æœéœ€è¦å®Œå…¨ä¸å¯å˜çš„ `Map`**
å¦‚æœå¸Œæœ› `Map` å†…å®¹ä¹Ÿä¸å¯å˜ï¼Œå¯ä»¥ä½¿ç”¨ï¼š
- **å†»ç»“å¯¹è±¡**ï¼ˆæµ…å±‚ä¸å¯å˜ï¼‰ï¼š
  ```javascript
  const map = new Map();
  Object.freeze(map); // ç¦æ­¢æ·»åŠ /åˆ é™¤å±æ€§ï¼ˆä½†ç°æœ‰é”®å€¼ä»å¯ä¿®æ”¹ï¼‰
  ```
- **ç¬¬ä¸‰æ–¹åº“**ï¼ˆå¦‚ Immutable.jsï¼‰ï¼š
  ```javascript
  import { Map } from 'immutable';
  const map = Map({ key: 'value' }); // å®Œå…¨ä¸å¯å˜
  ```

---

## **æ€»ç»“**
- `const` é™åˆ¶çš„æ˜¯å˜é‡åç»‘å®šï¼Œè€Œéå¼•ç”¨ç±»å‹çš„å†…å®¹ã€‚
- **`const + Map` è¡¨ç¤º**ï¼š
  - å˜é‡ `map` æ°¸è¿œæŒ‡å‘åŒä¸€ä¸ª `Map` å®ä¾‹ã€‚
  - ä½†å¯ä»¥è‡ªç”±ä¿®æ”¹è¯¥ `Map` çš„é”®å€¼å¯¹ï¼ˆå¢åˆ æ”¹æŸ¥ï¼‰ã€‚
- **æœ€ä½³å®è·µ**ï¼šé»˜è®¤ç”¨ `const`ï¼Œé™¤ééœ€è¦é‡æ–°èµ‹å€¼å†æ”¹ç”¨ `let`ã€‚



# Map

`Map` æ˜¯ JavaScript ä¸­ä¸€ç§éå¸¸å®ç”¨çš„æ•°æ®ç»“æ„ï¼Œå®ƒç±»ä¼¼äºå¯¹è±¡ï¼ˆ`Object`ï¼‰ï¼Œä½†æä¾›äº†æ›´å¼ºå¤§çš„é”®å€¼å¯¹å­˜å‚¨å’Œæ“ä½œèƒ½åŠ›ã€‚`Map` çš„é”®å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼ˆåŒ…æ‹¬å¯¹è±¡ã€å‡½æ•°ç­‰ï¼‰ï¼Œè€Œä¸ä»…ä»…æ˜¯å­—ç¬¦ä¸²æˆ– `Symbol`ã€‚ä»¥ä¸‹æ˜¯ `Map` çš„å„ç§ç”¨æ³•è¯¦è§£ï¼š



JSçš„å“ˆå¸Œå®ç°ï¼š

Object

Map

Set

---

## **1. åˆ›å»º Map**
```javascript
// åˆ›å»ºä¸€ä¸ªç©ºçš„ Map
const map = new Map();

// é€šè¿‡äºŒç»´æ•°ç»„åˆå§‹åŒ– Map
const mapWithData = new Map([
  ['key1', 'value1'],
  ['key2', 'value2'],
  [1, 'number key'],
  [{}, 'object key'],
]);
```

---

## **2. åŸºæœ¬æ“ä½œ**
### **ï¼ˆ1ï¼‰æ·»åŠ é”®å€¼å¯¹ `set(key, value)`**
```javascript
const map = new Map();
map.set('name', 'Alice');  // å­—ç¬¦ä¸²é”®
map.set(1, 'One');         // æ•°å­—é”®
map.set({ id: 1 }, 'User'); // å¯¹è±¡é”®
```

### **ï¼ˆ2ï¼‰è·å–å€¼ `get(key)`**
```javascript
console.log(map.get('name')); // 'Alice'
console.log(map.get(1));      // 'One'
console.log(map.get({ id: 1 })); // undefinedï¼ˆå› ä¸ºå¯¹è±¡å¼•ç”¨ä¸åŒï¼‰
```

### **ï¼ˆ3ï¼‰æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨ `has(key)`**
```javascript
console.log(map.has('name')); // true
console.log(map.has('age'));  // false
```

### **ï¼ˆ4ï¼‰åˆ é™¤é”®å€¼å¯¹ `delete(key)`**
```javascript
map.delete('name'); // åˆ é™¤ 'name' é”®
console.log(map.has('name')); // false
```

### **ï¼ˆ5ï¼‰æ¸…ç©º Map `clear()`**
```javascript
map.clear();
console.log(map.size); // 0
```

### **ï¼ˆ6ï¼‰è·å– Map å¤§å° `size`**
```javascript
console.log(map.size); // è¿”å›é”®å€¼å¯¹çš„æ•°é‡
```

---

## **3. éå† Map**
`Map` æä¾›äº†å¤šç§éå†æ–¹å¼ï¼š

### **ï¼ˆ1ï¼‰`keys()`ï¼šè·å–æ‰€æœ‰é”®**
```javascript
for (const key of map.keys()) {
  console.log(key);
}
```

### **ï¼ˆ2ï¼‰`values()`ï¼šè·å–æ‰€æœ‰å€¼**
```javascript
for (const value of map.values()) {
  console.log(value);
}
```

### **ï¼ˆ3ï¼‰`entries()`ï¼šè·å–æ‰€æœ‰é”®å€¼å¯¹**
```javascript
for (const [key, value] of map.entries()) {
  console.log(key, value);
}
// ç­‰åŒäºï¼š
for (const [key, value] of map) {
  console.log(key, value);
}
```

### **ï¼ˆ4ï¼‰`forEach()` éå†**
```javascript
map.forEach((value, key) => {
  console.log(key, value);
});
```

---

## **4. Map ä¸ Object çš„åŒºåˆ«**
| ç‰¹æ€§         | Map                       | Object                                   |
| ------------ | ------------------------- | ---------------------------------------- |
| **é”®çš„ç±»å‹** | ä»»æ„ç±»å‹ï¼ˆå¯¹è±¡ã€å‡½æ•°ç­‰ï¼‰  | ä»…é™å­—ç¬¦ä¸²æˆ– `Symbol`                    |
| **é¡ºåº**     | æŒ‰æ’å…¥é¡ºåºéå†            | ä¸ä¿è¯é¡ºåºï¼ˆES6 åéƒ¨åˆ†æœ‰åºï¼‰             |
| **å¤§å°**     | é€šè¿‡ `size` è·å–          | æ‰‹åŠ¨è®¡ç®—ï¼ˆå¦‚ `Object.keys(obj).length`ï¼‰ |
| **æ€§èƒ½**     | é¢‘ç¹å¢åˆ æ—¶æ›´å¿«            | é¢‘ç¹å¢åˆ æ—¶è¾ƒæ…¢ï¼ˆéœ€ä¼˜åŒ–ï¼‰                 |
| **é»˜è®¤é”®**   | æ— é»˜è®¤é”®ï¼ˆå¦‚ `toString`ï¼‰ | å¯èƒ½æœ‰åŸå‹é“¾ä¸Šçš„é”®                       |

---

## **5. é«˜çº§ç”¨æ³•**
### **ï¼ˆ1ï¼‰ä½¿ç”¨å¯¹è±¡ä½œä¸ºé”®**
```javascript
const user1 = { id: 1 };
const user2 = { id: 2 };

const userMap = new Map();
userMap.set(user1, 'Alice');
userMap.set(user2, 'Bob');

console.log(userMap.get(user1)); // 'Alice'
```

### **ï¼ˆ2ï¼‰Map è½¬æ¢ä¸ºæ•°ç»„**
```javascript
const map = new Map([
  ['a', 1],
  ['b', 2],
]);

// è½¬æ¢ä¸ºé”®æ•°ç»„
const keys = [...map.keys()]; // ['a', 'b']

// è½¬æ¢ä¸ºå€¼æ•°ç»„
const values = [...map.values()]; // [1, 2]

// è½¬æ¢ä¸ºé”®å€¼å¯¹æ•°ç»„
const entries = [...map.entries()]; // [['a', 1], ['b', 2]]
```

### **ï¼ˆ3ï¼‰æ•°ç»„/å¯¹è±¡è½¬æ¢ä¸º Map**
```javascript
// äºŒç»´æ•°ç»„ â†’ Map
const arr = [['a', 1], ['b', 2]];
const mapFromArr = new Map(arr);

// å¯¹è±¡ â†’ Map
const obj = { a: 1, b: 2 };
const mapFromObj = new Map(Object.entries(obj));
```

### **ï¼ˆ4ï¼‰Map åˆå¹¶**
```javascript
const map1 = new Map([['a', 1]]);
const map2 = new Map([['b', 2]]);

const mergedMap = new Map([...map1, ...map2]);
console.log([...mergedMap]); // [['a', 1], ['b', 2]]
```

---

## **6. å®é™…åº”ç”¨åœºæ™¯**
### **ï¼ˆ1ï¼‰ç¼“å­˜æ•°æ®**
```javascript
const cache = new Map();

function getData(key) {
  if (cache.has(key)) {
    return cache.get(key);
  }
  const data = fetchDataFromServer(key); // å‡è®¾æ˜¯è€—æ—¶æ“ä½œ
  cache.set(key, data);
  return data;
}
```

### **ï¼ˆ2ï¼‰ç»Ÿè®¡è¯é¢‘**
```javascript
function countWords(text) {
  const words = text.split(' ');
  const freqMap = new Map();

  for (const word of words) {
    freqMap.set(word, (freqMap.get(word) || 0) + 1);
  }

  return freqMap;
}
```

### **ï¼ˆ3ï¼‰å®ç° LRU ç¼“å­˜ï¼ˆæœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼‰**
```javascript
class LRUCache {
  constructor(capacity) {
    this.capacity = capacity;
    this.cache = new Map();
  }

  get(key) {
    if (!this.cache.has(key)) return -1;
    const value = this.cache.get(key);
    this.cache.delete(key);
    this.cache.set(key, value); // æ›´æ–°è®¿é—®é¡ºåº
    return value;
  }

  put(key, value) {
    if (this.cache.has(key)) {
      this.cache.delete(key);
    } else if (this.cache.size >= this.capacity) {
      // åˆ é™¤æœ€ä¹…æœªä½¿ç”¨çš„é”®
      const oldestKey = this.cache.keys().next().value;
      this.cache.delete(oldestKey);
    }
    this.cache.set(key, value);
  }
}
```

---

## **7. æ€»ç»“**
- **`Map` é€‚ç”¨äºéœ€è¦é”®å€¼å¯¹å­˜å‚¨ä¸”é”®ç±»å‹å¤šæ ·çš„åœºæ™¯**ã€‚
- **æ¯” `Object` æ›´çµæ´»**ï¼Œæ”¯æŒä»»æ„é”®ç±»å‹ã€ä¿æŒæ’å…¥é¡ºåºã€æä¾›ä¾¿æ·çš„éå†æ–¹æ³•ã€‚
- **å¸¸ç”¨æ–¹æ³•**ï¼š`set()`ã€`get()`ã€`has()`ã€`delete()`ã€`clear()`ã€`size`ã€‚
- **éå†æ–¹å¼**ï¼š`keys()`ã€`values()`ã€`entries()`ã€`forEach()`ã€‚
- **é€‚ç”¨åœºæ™¯**ï¼šç¼“å­˜ã€è¯é¢‘ç»Ÿè®¡ã€LRU ç¼“å­˜ç­‰ã€‚

å¸Œæœ›è¿™ä»½æŒ‡å—èƒ½å¸®åŠ©ä½ å…¨é¢æŒæ¡ `Map` çš„ç”¨æ³•ï¼ ğŸš€



çœ‹èµ·æ¥ä½ æƒ³äº†è§£çš„æ˜¯ `NaN`ï¼ˆNot a Numberï¼‰ï¼Œè€Œä¸æ˜¯ "Nancy"ï¼ˆè¿™æ˜¯ä¸€ä¸ªè‹±æ–‡åå­—ï¼‰ã€‚  

# **å…³äº `NaN`ï¼ˆNot a Numberï¼‰**  
`NaN` æ˜¯ JavaScript ä¸­çš„ä¸€ä¸ªç‰¹æ®Šå€¼ï¼Œè¡¨ç¤º **"ä¸æ˜¯ä¸€ä¸ªæœ‰æ•ˆçš„æ•°å­—"**ã€‚å®ƒé€šå¸¸å‡ºç°åœ¨æ•°å­¦è¿ç®—å¤±è´¥æˆ–ç»“æœæ— æ³•è¡¨ç¤ºä¸ºæœ‰æ•ˆæ•°å­—çš„æƒ…å†µä¸‹ã€‚  

#### **å…³é”®ç‰¹æ€§ï¼š**
1. **`NaN` çš„ç±»å‹æ˜¯ `number`**  
   ```js
   console.log(typeof NaN); // "number"
   ```
   è™½ç„¶å®ƒè¡¨ç¤º "ä¸æ˜¯ä¸€ä¸ªæ•°å­—"ï¼Œä½†å®ƒåœ¨ JavaScript ä¸­è¢«å½’ç±»ä¸º `number` ç±»å‹ã€‚

2. **`NaN` ä¸ç­‰äºä»»ä½•å€¼ï¼ŒåŒ…æ‹¬å®ƒè‡ªå·±**  
   ```js
   console.log(NaN === NaN); // false
   console.log(NaN == NaN);  // false
   ```
   è¿™æ˜¯ JavaScript ä¸­å”¯ä¸€ä¸€ä¸ª **ä¸ç­‰äºè‡ªèº«** çš„å€¼ã€‚

3. **å¦‚ä½•æ£€æµ‹ `NaN`ï¼Ÿ**  
   ç”±äº `NaN` ä¸ç­‰äºè‡ªèº«ï¼Œä¸èƒ½ç›´æ¥ç”¨ `===` åˆ¤æ–­ï¼Œè€Œæ˜¯è¦ç”¨ï¼š
   ```js
   console.log(isNaN(NaN));      // true
   console.log(Number.isNaN(NaN)); // true
   ```
   - `isNaN()`ï¼šä¼šå…ˆå°è¯•æŠŠå€¼è½¬æ¢æˆæ•°å­—ï¼Œå†åˆ¤æ–­æ˜¯å¦æ˜¯ `NaN`ï¼ˆå¯èƒ½è¯¯åˆ¤å­—ç¬¦ä¸²ç­‰ï¼‰ã€‚
   - `Number.isNaN()`ï¼šä¸¥æ ¼æ£€æŸ¥ï¼Œåªæœ‰ `NaN` æ‰è¿”å› `true`ï¼ˆæ¨èä½¿ç”¨ï¼‰ã€‚

4. **`NaN` çš„äº§ç”Ÿåœºæ™¯**  
   - æ•°å­¦è¿ç®—å¤±è´¥ï¼š
     ```js
     console.log(0 / 0);        // NaN
     console.log(Math.sqrt(-1)); // NaN
     ```
   - å­—ç¬¦ä¸²è§£æå¤±è´¥ï¼š
     ```js
     console.log(parseInt("abc")); // NaN
     ```
   - ä¸ `NaN` è¿›è¡Œè¿ç®—ï¼š
     ```js
     console.log(NaN + 5); // NaN
     ```

---

### **ä½ çš„ä»£ç ç¤ºä¾‹åˆ†æ**
```js
function add(a, b) {
    if (typeof a !== 'number' || typeof b !== 'number') {
        throw new TypeError('å‚æ•°ç±»å‹é”™è¯¯');
    }
    return a + b;
}

console.log(add(NaN, 2)); // è¾“å‡º: NaN
```
- `NaN` æ˜¯ `number` ç±»å‹ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘ `TypeError`ã€‚  
- ä½† `NaN + 2` ä»ç„¶æ˜¯ `NaN`ï¼Œå› ä¸º `NaN` ä¼šæ±¡æŸ“æ‰€æœ‰æ•°å­¦è¿ç®—ã€‚

#### **å¦‚ä½•ä¿®å¤ï¼Ÿ**
å¦‚æœä½ æƒ³åœ¨å‚æ•°æ˜¯ `NaN` æ—¶ä¹ŸæŠ›å‡ºé”™è¯¯ï¼Œå¯ä»¥å¢åŠ æ£€æŸ¥ï¼š
```js
function add(a, b) {
    if (typeof a !== 'number' || typeof b !== 'number' || isNaN(a) || isNaN(b)) {
        throw new TypeError('å‚æ•°å¿…é¡»æ˜¯æœ‰æ•ˆçš„æ•°å­—');
    }
    return a + b;
}

console.log(add(NaN, 2)); // æŠ›å‡ºé”™è¯¯: "å‚æ•°å¿…é¡»æ˜¯æœ‰æ•ˆçš„æ•°å­—"
```

---

### **æ€»ç»“**
- `NaN` è¡¨ç¤ºæ— æ•ˆçš„æ•°å­—ï¼Œä½†ç±»å‹æ˜¯ `number`ã€‚  
- ç”¨ `Number.isNaN()` æ£€æµ‹ `NaN` æœ€å¯é ã€‚  
- åœ¨ä¸¥æ ¼çš„æ•°å€¼è®¡ç®—ä¸­ï¼Œåº”è¯¥é¢å¤–æ£€æŸ¥ `NaN`ï¼Œé¿å…æ„å¤–è¡Œä¸ºã€‚  

å¸Œæœ›è¿™èƒ½å¸®ä½ ç†æ¸… `NaN` çš„æ¦‚å¿µï¼å¦‚æœæœ‰å…¶ä»–é—®é¢˜ï¼Œæ¬¢è¿ç»§ç»­æé—®ã€‚ ğŸ˜Š